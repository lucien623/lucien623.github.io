<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Lucien</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Lucien">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Lucien">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Lucien">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Lucien" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Lucien</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-baidu-bing-and-google" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/03/19/baidu-bing-and-google/" class="article-date">
  <time datetime="2023-03-19T15:13:05.000Z" itemprop="datePublished">2023-03-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/03/19/baidu-bing-and-google/">baidu bing and google</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/19/baidu-bing-and-google/" data-id="clffjf6ob0000xj1weck6e94x" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Deadlock-in-Java" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/01/05/Deadlock-in-Java/" class="article-date">
  <time datetime="2023-01-05T07:59:32.000Z" itemprop="datePublished">2023-01-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/01/05/Deadlock-in-Java/">Deadlock in Java</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="形成-deadlock-的四个条件"><a href="#形成-deadlock-的四个条件" class="headerlink" title="形成 deadlock 的四个条件"></a>形成 deadlock 的四个条件</h3><ol>
<li><code>no preemption（禁止抢夺）</code>：线程在未使用完资源之前不能被强制剥夺</li>
<li><code>hold and wait（持有和等待）</code>：一个线程可以在等待时持有资源</li>
<li><code>mutual exclusion（互斥）</code>：资源只能同时分配给一个线程使用，无法多个线程共用</li>
<li><code>circular waiting（循环等待）</code>：一系列线程互相持有其它线程所需要的资源，形成一种头尾相接的等待关系。</li>
</ol>
<p>在介绍死锁的一些类型之前先介绍一下 Java 中的 <code>synchronized</code> 关键字，<code>synchronized</code> 可以有三种使用方式：</p>
<ol>
<li><p>修饰实例方法（锁作用于当前实例）    </p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修饰静态方法（锁作用于 class 对象）  </p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修饰对象（锁作用于括号中的对象）   </p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="comment">//此时锁作用于括号中的 this 即当前实例</span></span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="deadlock-的几种类型"><a href="#deadlock-的几种类型" class="headerlink" title="deadlock 的几种类型"></a>deadlock 的几种类型</h3><ol>
<li><p>静态死锁</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockDemo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">objectA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">objectB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">methodA</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (objectA) &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">            <span class="keyword">synchronized</span> (objectB) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;methodA&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">methodB</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (objectB) &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">            <span class="keyword">synchronized</span> (objectA) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;methodB&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">LockDemo</span> <span class="variable">demo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LockDemo</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    demo.methodA();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    demo.methodB();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 如上代码所示，当两个线程分别执行 <code>methodA</code> 和 <code>methodB</code> 方法时，第一个线程调用持有了对象 <code>objectA</code> 的锁，等待对象 <code>objectB</code> 的锁，而第二个线程则相反，持有对象 <code>objectB</code> 的锁，等待对象 <code>objectA</code> 的锁，这样就形成了 circular waiting，导致了死锁。防止这种死锁形成的方法是在两个方法中对两个对象加锁顺序保持一致。</p>
</li>
<li><p>动态死锁</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicLockDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dynamicMethod</span><span class="params">(Object objA, Object objB)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (objA) &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">            <span class="keyword">synchronized</span> (objB) &#123;</span><br><span class="line">                <span class="comment">// <span class="doctag">TODO:</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">DynamicLockDemo</span> <span class="variable">demo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DynamicLockDemo</span>();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">objA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">objB</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    demo.dynamicMethod(objA, objB);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    demo.dynamicMethod(objB, objA);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">   	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 如上所示，当两个线程分别调用 dynamicMethod 方法时，第一个线程获取了对象 objA 的锁，等待 objB 的锁，第二个线程获取了对象 objB 的锁，等待 objA 的锁，从而形成了死锁。解决这种死锁的方法如下：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dynamicMethod</span><span class="params">(Object objA, Object objB)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">       <span class="comment">// 通过 System.identityHashCode 防止重写 hashCode()</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">hashA</span> <span class="operator">=</span> System.identityHashCode(objA);</span><br><span class="line">       <span class="type">int</span> <span class="variable">hashB</span> <span class="operator">=</span> System.identityHashCode(objB);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (hashA &lt; hashB) &#123;</span><br><span class="line">           <span class="keyword">synchronized</span> (objA) &#123;</span><br><span class="line">               Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">               <span class="keyword">synchronized</span> (objB) &#123;</span><br><span class="line">                   <span class="comment">// <span class="doctag">TODO:</span></span></span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hashA &gt; hashB) &#123;</span><br><span class="line">           <span class="keyword">synchronized</span> (objB) &#123;</span><br><span class="line">               Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">               <span class="keyword">synchronized</span> (objA) &#123;</span><br><span class="line">                   <span class="comment">// <span class="doctag">TODO:</span></span></span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">               <span class="keyword">synchronized</span> (objA) &#123;</span><br><span class="line">                   Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                   <span class="keyword">synchronized</span> (objB) &#123;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 通过比较 identityHashCode 的方式，始终把较小值的对象放在前面保证不同线程调用的时候锁顺序相同从而避免产生死锁（当 hashcode 相同时，则在外层再加一个对象锁）。</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/01/05/Deadlock-in-Java/" data-id="clffj1r5k000jqn1wbqdf8nf9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-斯多葛主义" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2023/01/01/%E6%96%AF%E5%A4%9A%E8%91%9B%E4%B8%BB%E4%B9%89/" class="article-date">
  <time datetime="2023-01-01T14:33:48.000Z" itemprop="datePublished">2023-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%98%85%E8%AF%BB/">阅读</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2023/01/01/%E6%96%AF%E5%A4%9A%E8%91%9B%E4%B8%BB%E4%B9%89/">斯多葛主义</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="斯多葛主义的心理技巧"><a href="#斯多葛主义的心理技巧" class="headerlink" title="斯多葛主义的心理技巧"></a>斯多葛主义的心理技巧</h3><ul>
<li><p>消极想象</p>
<p>  消极想象的三个好处：一是当我们做消极想象的时候，会尽力去避免消极想象的事情发生；二是当消极想象中的事情真的发生时，通过这种方式可以减轻由此带来的痛苦；三是进行消极想象可以阻止我们享乐适应，因为人们通常在满足某种欲望的时候，往往持续的幸福不会很久就会乏味，消极想象可以防止这种幸福感的消失。</p>
</li>
<li><p>控制三分法</p>
<p>  控制三分法将事物分成三种类别。第一种是我们完全能够控制的事物，比如我们的目标和价值观；第二种是我们一点也不能控制的事物，比如明天是否会出现太阳；第三种则是我们能够控制一些但却有不能完全控制的事物，比如能否赢下一场网球赛。控制三分法让我们应当关注第一种事物，不关注第二种事物，在面对第三种我们能够控制一些但又无法完全控制的事物时，我们应当将外在目标内在化，比如应该将「使他爱我」这个目标转换成让自己值得被爱；面对老板，尽自己的最大努力做好工作，不论随后老板对我有什么反应。</p>
</li>
<li><p>宿命论</p>
<p>  我们应当针对过去和现在采用宿命论，「接受命运的安排」，拒绝考虑自身的情况如何可能会变得更好（对过去的懊悔）。</p>
</li>
<li><p>自我否定</p>
<p>  斯多葛主义不仅要求我们进行消极想象，还建议我们应时不常地给自己制造机会去经历本来可以避免的不舒适。对于这种行为的好处可以有三点：一是可以使得我们变得更加坚韧，以便抵御将来可能降临的命运；二是经历微小不适可以使自己变得有信心，认为自己同样可以承受更严重的不信；三是可以帮助我们享受我们已经拥有的东西。</p>
</li>
<li><p>沉思：监督自我践行斯多葛主义</p>
<p>  我们应当定期对日常生活中的事情进行思考，根据斯多葛主义的原则，应该如何处理发生的事情。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/01/01/%E6%96%AF%E5%A4%9A%E8%91%9B%E4%B8%BB%E4%B9%89/" data-id="clffj1r5p001xqn1w8tslfutt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-记关于Fragment-java-lang-NoSuchMethodException的一个报错" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/02/15/%E8%AE%B0%E5%85%B3%E4%BA%8EFragment-java-lang-NoSuchMethodException%E7%9A%84%E4%B8%80%E4%B8%AA%E6%8A%A5%E9%94%99/" class="article-date">
  <time datetime="2022-02-15T05:55:48.000Z" itemprop="datePublished">2022-02-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/02/15/%E8%AE%B0%E5%85%B3%E4%BA%8EFragment-java-lang-NoSuchMethodException%E7%9A%84%E4%B8%80%E4%B8%AA%E6%8A%A5%E9%94%99/">记关于Fragment-java.lang.NoSuchMethodException的一个报错</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>春节回来之后瞄了眼 bugly，发现了一个发生频次高影响用户广的 bug:</p>
<p><code>java.lang.RuntimeException:Unable to start activity ComponentInfo&#123;.ui.activity.HomeActivity&#125;: androidx.fragment.app.Fragment$InstantiationException: Unable to instantiate fragment .ui.fragment.q: could not find Fragment constructor</code></p>
<p>搜索了问题之后发现原因很简单，同事在创建的<code>Fragment</code>的时候用了带参数的构造方法，而没有添加无参构造，从而导致了这个 runtime exception，来看一下官方文档的解释：</p>
<p><code>All subclasses of Fragment must include a public no-argument constructor. The framework will often re-instantiate a fragment class when needed, in particular during state restore, and needs to be able to find this constructor to instantiate it. If the no-argument constructor is not available, a runtime exception will occur in some cases during state restore</code></p>
<p>从这段说明中可以看出所有的<code>Fragment</code>子类都必须包含无参的构造方法，系统在根据需要重新实例化<code>Fragment</code>子类时会默认去调用无参构造方法，如果没有找到这个无参方法，则会导致运行时错误。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/02/15/%E8%AE%B0%E5%85%B3%E4%BA%8EFragment-java-lang-NoSuchMethodException%E7%9A%84%E4%B8%80%E4%B8%AA%E6%8A%A5%E9%94%99/" data-id="clffj1r5p0024qn1w99qp2a5h" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2021-年喜欢的一些东西" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/31/2021-%E5%B9%B4%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF/" class="article-date">
  <time datetime="2021-12-31T13:22:08.000Z" itemprop="datePublished">2021-12-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/31/2021-%E5%B9%B4%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF/">2021 年喜欢的一些东西</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>  <strong>喜欢的电子产品：</strong></p>
<p>  <code>AirPods Pro</code>。最初我计划买这耳机是因为用有线耳机的同时没法给手机充电，但当我入手之后发现降噪功能实在是太强大，戴上耳机之后世界瞬间清净了，减少了许多外界的打扰，后悔没有早点买，要说耳机的缺点么就是续航稍微有点短，至于音质当然和大法是没法比的，但也还能听。</p>
<p>  <code>KeychronK2</code>。非常棒的键盘，完美适配 mac，我买的是红轴，键盘敲击的声音不大，适合办公室，怎么说呢，用它来敲代码会有种停不下来的感觉，生产力加成。</p>
<p>  <strong>喜欢的运动：</strong></p>
<p>  <code>羽毛球</code>。开始打羽毛球是 6 月份的时候，契机是公司旁边开了一个羽毛球馆，因为之前一年的身体一直比较差没怎么运动，所以下决心报了一个羽毛球培训班学习，强身健体。喜欢羽毛球不仅仅是因为这项运动本身具有很多乐趣，同时因为从开始打羽毛球到现在的这半年里认识了好多好多新朋友，一起打球，一起玩耍，特别开心。</p>
<p>  <strong>喜欢的电影：</strong></p>
<p>  <code>阿黛尔的生活</code>。性与爱，太美了。</p>
<p>  <strong>喜欢的播客：</strong></p>
<p>  <code>谐星聊天会</code>。每周三都期盼着它更新，下班路上听经常走着走着就笑出来了，感谢插话师，感谢天花板，我的快乐源泉。</p>
<p>  <strong>喜欢的歌：</strong><br>  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1483980586&auto=0&height=66"></iframe></p>
<p>  <code>与我常在</code>这个 2013 年的 Live 版本绝了。<br>  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=28160884&auto=0&height=66"></iframe></p>
<p>  在我失落的时候这首歌总能给我力量与希望。<br>  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1399050282&auto=0&height=66"></iframe></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/31/2021-%E5%B9%B4%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF/" data-id="clffj1r5d0001qn1whijogrma" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android-存储-API" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/14/Android-%E5%AD%98%E5%82%A8-API/" class="article-date">
  <time datetime="2021-12-14T11:56:02.000Z" itemprop="datePublished">2021-12-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/14/Android-%E5%AD%98%E5%82%A8-API/">Android 存储 API</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="internal-storage-对应的存储目录"><a href="#internal-storage-对应的存储目录" class="headerlink" title="internal storage 对应的存储目录"></a>internal storage 对应的存储目录</h3><p>getCacheDir(): <code>/data/data/&lt;application package&gt;/cache</code></p>
<p>getFilesDir(): <code>/data/data/&lt;application package&gt;/files</code></p>
<h3 id="external-storage-对应的存储目录"><a href="#external-storage-对应的存储目录" class="headerlink" title="external storage 对应的存储目录"></a>external storage 对应的存储目录</h3><p>getExternalFilesDir(): <code>/sdcard/Android/data/&lt;application package&gt;/files</code></p>
<p>getExternalCacheDir() : <code>/sdcard/Android/data/&lt;application package&gt;/cache</code></p>
<p>一般来说手机外部存储的空间比较大，所以如果需要保存比较大的文件时，应当存储在外部存储中。internal storage 和 external storage 在 app 被删除后相应的文件都会被删除。</p>
<p>如果需要存储不跟随 app 删除的文件，可以通过获取外部存储路径的方式</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">File</span> <span class="variable">sdCardFile</span> <span class="operator">=</span> Environment.getExternalStorageDirectory();</span><br><span class="line"><span class="type">File</span> <span class="variable">sdPic</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(sdCardFile, <span class="string">&quot;Pictures&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">File</span> <span class="variable">sdDoc</span> <span class="operator">=</span> Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOCUMENTS);</span><br></pre></td></tr></table></figure>

<p>前一种方式自己指定目录，后一种根据系统提供的参数获取目录。</p>
<p>在使用外部存储之前最好先加一个是否存在外部存储的判断</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Environment.isExternalStorageEmulated() 判断设备的外存是否是用内存模拟</span></span><br><span class="line">Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState()) || !Environment.isExternalStorageEmulated()</span><br></pre></td></tr></table></figure>

<p>更多关于存储的开发指南可以去 <a target="_blank" rel="noopener" href="https://developer.android.com/training/data-storage?hl=zh-cn">developer</a> 网站参考。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/12/14/Android-%E5%AD%98%E5%82%A8-API/" data-id="clffj1r5h0006qn1wbjhscz0a" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-关于PendingIntent数据重复问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/12/%E5%85%B3%E4%BA%8EPendingIntent%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2020-11-12T08:26:54.000Z" itemprop="datePublished">2020-11-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/12/%E5%85%B3%E4%BA%8EPendingIntent%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98/">关于PendingIntent数据重复问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前在测试推送的过程中发现了一个很奇怪的问题，就是当收到多条推送时，点击推送获取的到的数据都是第一条推送的，经过查找之后，发现了该问题的原因。接下来一段就是来自官网的描述</p>
<blockquote>
<p>A PendingIntent itself is simply a reference to a token maintained by the system describing the original data used to retrieve it. This means that, even if its owning application’s process is killed, the PendingIntent itself will remain usable from other processes that have been given it. If the creating application later re-retrieves the same kind of PendingIntent (same operation, same Intent action, data, categories, and components, and same flags), it will receive a PendingIntent representing the same token if that is still valid, and can thus call cancel() to remove it.<br>Because of this behavior, it is important to know when two Intents are considered to be the same for purposes of retrieving a PendingIntent. <strong>A common mistake people make is to create multiple PendingIntent objects with Intents that only vary in their “extra” contents, expecting to get a different PendingIntent each time.</strong> This does not happen. The parts of the Intent that are used for matching are the same ones defined by Intent#filterEquals(Intent). If you use two Intent objects that are equivalent as per Intent#filterEquals(Intent), then you will get the same PendingIntent for both of them.</p>
</blockquote>
<p>加粗部分的意思是说，如果<code>PendingIntent</code>只有在<code>Intent</code>中的<code>extra</code>不同的话，那么<code>PendingIntent</code>只会拿到相同的，即第一次的那个，所以问题就出现在这里，官方给了两种这个情况的解决方案</p>
<blockquote>
<p>If you truly need multiple distinct PendingIntent objects active at the same time (such as to use as two notifications that are both shown at the same time), then you will need to ensure there is something that is different about them to associate them with different PendingIntents. This may be any of the Intent attributes considered by Intent#filterEquals(Intent), or different request code integers supplied to getActivity(Context, int, Intent, int), getActivities(Context, int, Intent[], int), getBroadcast(Context, int, Intent, int), or getService(Context, int, Intent, int).<br>If you only need one PendingIntent active at a time for any of the Intents you will use, then you can alternatively use the flags FLAG_CANCEL_CURRENT or FLAG_UPDATE_CURRENT to either cancel or modify whatever current PendingIntent is associated with the Intent you are supplying.</p>
</blockquote>
<p>第一种方式就是给<code>Intent</code>设置不同的<code>filter</code>或者<code>request code</code>；第二种方式是如果不需要多个<code>PendingIntent</code>，那么可以在<code>flags</code>参数中传入<code>FLAG_CANCEL_CURRENT</code>或者<code>FLAG_UPDATE_CURRENT</code>将<code>PendingIntent</code>更新为最新的那个。因为我这边的情形是需要保留所有的不同的<code>PendingIntent</code>，所以采用了第一种方式，问题解决。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/11/12/%E5%85%B3%E4%BA%8EPendingIntent%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A4%8D%E9%97%AE%E9%A2%98/" data-id="clffj1r5o001kqn1w6qsp6omb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/android/" rel="tag">android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flutter-更新失败问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/26/Flutter-%E6%9B%B4%E6%96%B0%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2020-05-26T01:35:24.000Z" itemprop="datePublished">2020-05-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/26/Flutter-%E6%9B%B4%E6%96%B0%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/">Flutter 更新失败问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天在执行<code>flutter upgrade</code>更新<code>flutter</code>时发现了一个更新失败问题：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to retrieve the Dart SDK from: https://storage.googleapis.com/flutter_infra/flutter/6bc433c6b6b5b98dcf4cc11aff31cdee90849f32/dart-sdk-darwin-x64.zip</span><br></pre></td></tr></table></figure>

<p>发生这个问题的主要原因就是这个地址被墙了，官方也给出了<a target="_blank" rel="noopener" href="https://flutter.dev/community/china">解决方案</a>，就是给更新地址设置 mirror site，具体的方法就是在 Bash shell 中做如下设置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export PUB_HOSTED_URL=https://pub.flutter-io.cn</span><br><span class="line">export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn</span><br><span class="line">git clone -b dev https://github.com/flutter/flutter.git</span><br><span class="line">export PATH=&quot;$PWD/flutter/bin:$PATH&quot;</span><br><span class="line">cd ./flutter</span><br><span class="line">flutter doctor</span><br></pre></td></tr></table></figure>
<p>除了这个 mirror site 之外，还可以用 Shanghai Jiaotong University Linux User Group 的 mirror site：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FLUTTER_STORAGE_BASE_URL: https:<span class="comment">//mirrors.sjtug.sjtu.edu.cn/</span></span><br><span class="line">PUB_HOSTED_URL: https:<span class="comment">//dart-pub.mirrors.sjtug.sjtu.edu.cn/</span></span><br></pre></td></tr></table></figure>
<p>设置好之后就可以发会呆等待其 download 完成了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/05/26/Flutter-%E6%9B%B4%E6%96%B0%E5%A4%B1%E8%B4%A5%E9%97%AE%E9%A2%98/" data-id="clffj1r5o001nqn1w0ilzd1qb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/Flutter/" rel="tag">Flutter</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mac中修改host的方法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/11/mac%E4%B8%AD%E4%BF%AE%E6%94%B9host%E7%9A%84%E6%96%B9%E6%B3%95/" class="article-date">
  <time datetime="2019-12-11T01:22:16.000Z" itemprop="datePublished">2019-12-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/12/11/mac%E4%B8%AD%E4%BF%AE%E6%94%B9host%E7%9A%84%E6%96%B9%E6%B3%95/">mac中修改host的方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>输入命令<code>sudo vi /etc/hosts</code></p>
<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p>输入 pc 的密码</p>
<h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p>按<code>i</code>键进入编辑模式，修改 host</p>
<h3 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h3><p>编辑完成后，按<code>esc</code>键退出编辑模式</p>
<h3 id="Step-5"><a href="#Step-5" class="headerlink" title="Step 5"></a>Step 5</h3><p>同时按<code>shift</code>和<code>:</code>键，并输入<code>wq!</code>，按回车键即编辑完成</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/12/11/mac%E4%B8%AD%E4%BF%AE%E6%94%B9host%E7%9A%84%E6%96%B9%E6%B3%95/" data-id="clffj1r5n001hqn1w7u684h9y" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-重拾-DSA-之二叉搜索树" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/10/26/%E9%87%8D%E6%8B%BE-DSA-%E4%B9%8B%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" class="article-date">
  <time datetime="2019-10-26T05:49:48.000Z" itemprop="datePublished">2019-10-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/10/26/%E9%87%8D%E6%8B%BE-DSA-%E4%B9%8B%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/">重拾 DSA 之二叉搜索树</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>二叉搜索树即 Binary Search Tree，也可以称为二叉查找树或者有序二叉树。它可以是空树或者是具有以下性质的二叉树（from wiki）：</p>
<blockquote>
<p>1.若任意节点的左子树不空，则左子树上所有节点的值均小于它的根节点的值；<br>2.若任意节点的右子树不空，则右子树上所有节点的值均大于它的根节点的值；<br>3.任意节点的左、右子树也分别为二叉查找树；<br>4.没有键值相等的节点。</p>
</blockquote>
<p>首先定义节点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">	TreeNode left,right;</span><br><span class="line">	<span class="type">int</span> value, num = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">TreeNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.value = value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>插入节点，如果根节点为空则直接插入，否则与当前节点的值判断，如果大于当前节点，则和左子树中的节点判断，反之则和右子树中的节点做判断，直到比较到叶子节点最终确定插入位置，相等的特殊情况则将当前节点的 num 加 1，结束插入节点</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">insertNode</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(root == <span class="literal">null</span>) &#123;</span><br><span class="line">		root = node;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">TreeNode</span> <span class="variable">temp</span> <span class="operator">=</span> root;</span><br><span class="line">	<span class="keyword">for</span>(;;) &#123;</span><br><span class="line">		<span class="keyword">if</span>(node.value &gt; temp.value) &#123;</span><br><span class="line">			<span class="keyword">if</span>(temp.right != <span class="literal">null</span>)</span><br><span class="line">				temp = temp.right;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				temp.right = node;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (node.value &lt; temp.value) &#123;</span><br><span class="line">			<span class="keyword">if</span>(temp.left != <span class="literal">null</span>)</span><br><span class="line">				temp = temp.left;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				temp.left = node;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			temp.num++;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>删除节点的逻辑分三种情况，如果待删除的节点是叶子节点，那么可以直接删除；如果待删除的节点只有左子树或者右子树，那么可以重接左子树或右子树，即把待删除节点的左节点或者右节点直接替代；如果待删除节点既有左子树又有右子树，那么把左子树中的最小值替代待删除节点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">deleteNode</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(root == <span class="literal">null</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	TreeNode parent;</span><br><span class="line">	<span class="type">TreeNode</span> <span class="variable">current</span> <span class="operator">=</span> parent = root;</span><br><span class="line">	<span class="keyword">for</span>(;;)&#123;</span><br><span class="line">		<span class="keyword">if</span>(current.value == value)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		parent = current;</span><br><span class="line">		<span class="keyword">if</span>(current.value &lt; value)</span><br><span class="line">			current = current.right;</span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			current = current.left;</span><br><span class="line">		<span class="keyword">if</span>(current == <span class="literal">null</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//叶子节点，直接删除</span></span><br><span class="line">	<span class="keyword">if</span>(current.left == <span class="literal">null</span> &amp;&amp; current.right == <span class="literal">null</span>) &#123;</span><br><span class="line">		 actualDelete(parent, current, <span class="literal">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//左子树为空,重接右子树</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(current.left == <span class="literal">null</span>)&#123;</span><br><span class="line">		actualDelete(parent, current, current.right);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//右子树为空,重接左子树</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(current.right == <span class="literal">null</span>)&#123;</span><br><span class="line">		actualDelete(parent, current, current.left);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//左子树和右子树都不为空，那么将右子树中的最小节点替代被删除的节点</span></span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="type">TreeNode</span> <span class="variable">temp</span> <span class="operator">=</span> current.left;</span><br><span class="line">		<span class="type">TreeNode</span> <span class="variable">tempParent</span> <span class="operator">=</span> current;</span><br><span class="line">		<span class="keyword">while</span>(temp.left != <span class="literal">null</span>) &#123;</span><br><span class="line">			tempParent = temp;</span><br><span class="line">			temp = temp.left;</span><br><span class="line">		&#125;</span><br><span class="line">		actualDelete(parent, current, temp);</span><br><span class="line">		temp.left = current.left;</span><br><span class="line">		temp.right = current.right;</span><br><span class="line">		tempParent.left = <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">actualDelete</span><span class="params">(TreeNode parent, TreeNode deleteNode, TreeNode next)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(parent.left == deleteNode)</span><br><span class="line">		parent.left = next;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		parent.right = next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以用中序遍历输出有序序列</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inOrder</span><span class="params">(TreeNode node)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span>(node != <span class="literal">null</span>) &#123;</span><br><span class="line">		inOrder(node.left);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i &lt; node.num; i++)</span><br><span class="line">			System.out.print(node.value + <span class="string">&quot;--&gt;&quot;</span>);</span><br><span class="line">		inOrder(node.right);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>二叉搜索树查找、插入的期望复杂度是 O(log n)，最坏情况下即退化成线性表的时候为 O(n)。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/10/26/%E9%87%8D%E6%8B%BE-DSA-%E4%B9%8B%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/" data-id="clffj1r5q0026qn1w5x4318lr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags%C3%9F/DSA/" rel="tag">DSA</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">__(&#39;next&#39;) &amp;raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%98%85%E8%AF%BB/">阅读</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/DSA/" rel="tag">DSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/Flutter/" rel="tag">Flutter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/database/" rel="tag">database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags%C3%9F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags%C3%9F/DSA/" style="font-size: 16.67px;">DSA</a> <a href="/tags%C3%9F/Flutter/" style="font-size: 10px;">Flutter</a> <a href="/tags%C3%9F/Java/" style="font-size: 13.33px;">Java</a> <a href="/tags%C3%9F/android/" style="font-size: 20px;">android</a> <a href="/tags%C3%9F/database/" style="font-size: 10px;">database</a> <a href="/tags%C3%9F/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">一月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/03/19/baidu-bing-and-google/">baidu bing and google</a>
          </li>
        
          <li>
            <a href="/2023/01/05/Deadlock-in-Java/">Deadlock in Java</a>
          </li>
        
          <li>
            <a href="/2023/01/01/%E6%96%AF%E5%A4%9A%E8%91%9B%E4%B8%BB%E4%B9%89/">斯多葛主义</a>
          </li>
        
          <li>
            <a href="/2022/02/15/%E8%AE%B0%E5%85%B3%E4%BA%8EFragment-java-lang-NoSuchMethodException%E7%9A%84%E4%B8%80%E4%B8%AA%E6%8A%A5%E9%94%99/">记关于Fragment-java.lang.NoSuchMethodException的一个报错</a>
          </li>
        
          <li>
            <a href="/2021/12/31/2021-%E5%B9%B4%E5%96%9C%E6%AC%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E4%B8%9C%E8%A5%BF/">2021 年喜欢的一些东西</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2023 Lucien<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


  </div>
</body>
</html>